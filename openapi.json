{"openapi":"3.0.0","paths":{"/api":{"get":{"operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"string"}}}}},"tags":["App"]}},"/api/activities":{"post":{"operationId":"ActivitiesController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateActivityDto"}}}},"responses":{"201":{"description":"Activity created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActivityResponseDto"}}}},"400":{"description":"Validation error or entity not found"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["activities"]},"get":{"operationId":"ActivitiesController_findByEntity","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"entityType","required":true,"in":"query","schema":{"enum":["Lead","Client","Request","Offer","Booking"],"type":"string"}},{"name":"entityId","required":true,"in":"query","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","schema":{"type":"number"}},{"name":"limit","required":false,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"Activities for the given entity","content":{"application/json":{"schema":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/ActivityResponseDto"}},"total":{"type":"number"},"page":{"type":"number"},"limit":{"type":"number"}}}}}},"400":{"description":"Missing entityType/entityId"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["activities"]}},"/api/activities/{id}":{"get":{"operationId":"ActivitiesController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Activity found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActivityResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Activity not found"}},"security":[{"access-token":[]}],"tags":["activities"]}},"/api/bookings":{"post":{"operationId":"BookingsController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateBookingDto"}}}},"responses":{"201":{"description":"Booking created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookingResponseDto"}}}},"400":{"description":"Invalid body, offer not SENT/ACCEPTED, or booking already exists"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["bookings"]},"get":{"operationId":"BookingsController_findAll","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}},{"name":"status","required":false,"in":"query","description":"Filter by booking status","schema":{"type":"string","enum":["CONFIRMED","CANCELLED"]}}],"responses":{"200":{"description":"Paginated list of bookings","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedBookingResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["bookings"]}},"/api/bookings/{id}":{"get":{"operationId":"BookingsController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Booking found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookingResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Booking not found"}},"security":[{"access-token":[]}],"tags":["bookings"]},"patch":{"operationId":"BookingsController_update","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateBookingDto"}}}},"responses":{"200":{"description":"Booking updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookingResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Booking not found"}},"security":[{"access-token":[]}],"tags":["bookings"]},"delete":{"operationId":"BookingsController_remove","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Booking deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookingResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Booking not found"}},"security":[{"access-token":[]}],"tags":["bookings"]}},"/api/clients":{"post":{"operationId":"ClientsController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateClientDto"}}}},"responses":{"201":{"description":"Client created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClientResponseDto"}}}},"400":{"description":"Invalid body or validation error"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["clients"]},"get":{"operationId":"ClientsController_findAll","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}},{"name":"type","required":false,"in":"query","description":"Filter by client type","schema":{"type":"string","enum":["INDIVIDUAL","AGENT"]}}],"responses":{"200":{"description":"Paginated list of clients","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedClientResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["clients"]}},"/api/clients/{id}":{"get":{"operationId":"ClientsController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Client found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClientResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Client not found"}},"security":[{"access-token":[]}],"tags":["clients"]},"patch":{"operationId":"ClientsController_update","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateClientDto"}}}},"responses":{"200":{"description":"Client updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClientResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Client not found"}},"security":[{"access-token":[]}],"tags":["clients"]},"delete":{"operationId":"ClientsController_remove","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Client soft-deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClientResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Client not found"}},"security":[{"access-token":[]}],"tags":["clients"]}},"/api/comments":{"post":{"operationId":"CommentsController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCommentDto"}}}},"responses":{"201":{"description":"Comment created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommentResponseDto"}}}},"400":{"description":"Validation error or entity not found"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["comments"]},"get":{"operationId":"CommentsController_findByEntity","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"commentableType","required":true,"in":"query","schema":{"enum":["Lead","Client","Request","Offer","Booking"],"type":"string"}},{"name":"commentableId","required":true,"in":"query","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","schema":{"type":"number"}},{"name":"limit","required":false,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"Comments for the given entity","content":{"application/json":{"schema":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/CommentResponseDto"}},"total":{"type":"number"},"page":{"type":"number"},"limit":{"type":"number"}}}}}},"400":{"description":"Missing commentableType/commentableId"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["comments"]}},"/api/comments/{id}":{"get":{"operationId":"CommentsController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Comment found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommentResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Comment not found"}},"security":[{"access-token":[]}],"tags":["comments"]},"delete":{"operationId":"CommentsController_remove","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Comment soft-deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommentResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Comment not found"}},"security":[{"access-token":[]}],"tags":["comments"]}},"/api/invoices":{"post":{"operationId":"InvoicesController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateInvoiceDto"}}}},"responses":{"201":{"description":"Invoice created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponseDto"}}}},"400":{"description":"Invalid body or booking not confirmed"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["invoices"]},"get":{"operationId":"InvoicesController_findAll","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}},{"name":"status","required":false,"in":"query","description":"Filter by invoice status","schema":{"type":"string","enum":["DRAFT","SENT","PAID","CANCELLED"]}}],"responses":{"200":{"description":"Paginated list of invoices","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedInvoiceResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["invoices"]}},"/api/invoices/{id}":{"get":{"operationId":"InvoicesController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Invoice found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Invoice not found"}},"security":[{"access-token":[]}],"tags":["invoices"]},"patch":{"operationId":"InvoicesController_update","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateInvoiceDto"}}}},"responses":{"200":{"description":"Invoice updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Invoice not found"}},"security":[{"access-token":[]}],"tags":["invoices"]},"delete":{"operationId":"InvoicesController_remove","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Invoice deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvoiceResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Invoice not found"}},"security":[{"access-token":[]}],"tags":["invoices"]}},"/api/leads":{"post":{"operationId":"LeadsController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateLeadDto"}}}},"responses":{"201":{"description":"Lead created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadResponseDto"}}}},"400":{"description":"Invalid body or validation error"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["leads"]},"get":{"operationId":"LeadsController_findAll","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}}],"responses":{"200":{"description":"Paginated list of leads","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedLeadResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["leads"]}},"/api/leads/{id}":{"get":{"operationId":"LeadsController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Lead found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Lead not found"}},"security":[{"access-token":[]}],"tags":["leads"]},"patch":{"operationId":"LeadsController_update","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateLeadDto"}}}},"responses":{"200":{"description":"Lead updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Lead not found"}},"security":[{"access-token":[]}],"tags":["leads"]},"delete":{"operationId":"LeadsController_remove","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Lead soft-deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Lead not found"}},"security":[{"access-token":[]}],"tags":["leads"]}},"/api/leads/{id}/status":{"patch":{"operationId":"LeadsController_updateStatus","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateLeadStatusDto"}}}},"responses":{"200":{"description":"Lead status updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Lead not found"}},"security":[{"access-token":[]}],"tags":["leads"]}},"/api/leads/{id}/convert-to-client":{"post":{"operationId":"LeadsController_convertToClient","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"201":{"description":"Lead converted to client","content":{"application/json":{"schema":{"type":"object","properties":{"client":{"$ref":"#/components/schemas/ClientResponseDto"},"lead":{"$ref":"#/components/schemas/LeadResponseDto"}}}}}},"400":{"description":"Lead already converted"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Lead not found"}},"security":[{"access-token":[]}],"tags":["leads"]}},"/api/offers":{"get":{"operationId":"OffersController_findAll","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}},{"name":"status","required":false,"in":"query","description":"Filter by offer status","schema":{"type":"string","enum":["DRAFT","SENT","ACCEPTED","REJECTED","EXPIRED"]}}],"responses":{"200":{"description":"Paginated list of offers","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedOfferResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["offers"]},"post":{"operationId":"OffersController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateOfferDto"}}}},"responses":{"201":{"description":"Offer created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"400":{"description":"Invalid body, validation error, or request not in org"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["offers"]}},"/api/offers/{id}":{"get":{"operationId":"OffersController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Offer found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Offer not found"}},"security":[{"access-token":[]}],"tags":["offers"]},"patch":{"operationId":"OffersController_update","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateOfferDto"}}}},"responses":{"200":{"description":"Offer updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role, organization, or offer not in DRAFT"},"404":{"description":"Offer not found"}},"security":[{"access-token":[]}],"tags":["offers"]},"delete":{"operationId":"OffersController_remove","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Offer soft-deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role, organization, or offer not in DRAFT"},"404":{"description":"Offer not found"}},"security":[{"access-token":[]}],"tags":["offers"]}},"/api/offers/{id}/convert-to-booking":{"post":{"operationId":"OffersController_convertToBooking","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"201":{"description":"Offer converted to booking","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookingResponseDto"}}}},"400":{"description":"Offer not SENT/ACCEPTED or booking already exists"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Offer not found"}},"security":[{"access-token":[]}],"tags":["offers"]}},"/api/offers/{id}/status":{"patch":{"operationId":"OffersController_updateStatus","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateOfferStatusDto"}}}},"responses":{"200":{"description":"Offer status updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OfferResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Offer not found"}},"security":[{"access-token":[]}],"tags":["offers"]}},"/api/organizations":{"post":{"operationId":"OrganizationsController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateOrganizationDto"}}}},"responses":{"201":{"description":""}},"tags":["Organizations"]}},"/api/requests":{"post":{"operationId":"RequestsController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateRequestDto"}}}},"responses":{"201":{"description":"Request created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestResponseDto"}}}},"400":{"description":"Invalid body or validation error"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role, organization, or client/manager not in org"}},"security":[{"access-token":[]}],"tags":["requests"]},"get":{"operationId":"RequestsController_findAll","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}}],"responses":{"200":{"description":"Paginated list of requests","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedRequestResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["requests"]}},"/api/requests/{id}":{"get":{"operationId":"RequestsController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Request found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Request not found"}},"security":[{"access-token":[]}],"tags":["requests"]},"patch":{"operationId":"RequestsController_update","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateRequestDto"}}}},"responses":{"200":{"description":"Request updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Request not found"}},"security":[{"access-token":[]}],"tags":["requests"]},"delete":{"operationId":"RequestsController_remove","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Request soft-deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestResponseDto"}}}},"400":{"description":"Invalid UUID"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Request not found"}},"security":[{"access-token":[]}],"tags":["requests"]}},"/api/requests/{id}/status":{"patch":{"operationId":"RequestsController_updateStatus","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateRequestStatusDto"}}}},"responses":{"200":{"description":"Request status updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestResponseDto"}}}},"400":{"description":"Invalid UUID or body"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Request not found"}},"security":[{"access-token":[]}],"tags":["requests"]}},"/api/tags":{"post":{"operationId":"TagsController_create","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTagDto"}}}},"responses":{"201":{"description":"Tag created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TagResponseDto"}}}},"400":{"description":"Validation error or duplicate name"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["tags"]},"get":{"operationId":"TagsController_findAll","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"entityType","required":false,"in":"query","schema":{"enum":["Lead","Client","Request","Offer","Booking"],"type":"string"}},{"name":"entityId","required":false,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":"List of tags","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TagResponseDto"}}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"}},"security":[{"access-token":[]}],"tags":["tags"]}},"/api/tags/{id}":{"get":{"operationId":"TagsController_findById","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Tag found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TagResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Tag not found"}},"security":[{"access-token":[]}],"tags":["tags"]},"delete":{"operationId":"TagsController_remove","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Tag soft-deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TagResponseDto"}}}},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Tag not found"}},"security":[{"access-token":[]}],"tags":["tags"]}},"/api/tags/{id}/attach":{"post":{"operationId":"TagsController_attach","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AttachTagDto"}}}},"responses":{"200":{"description":"Tag attached to entity"},"201":{"description":""},"400":{"description":"Entity not found"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Tag not found"}},"security":[{"access-token":[]}],"tags":["tags"]}},"/api/tags/{id}/attach/{entityType}/{entityId}":{"delete":{"operationId":"TagsController_detach","parameters":[{"name":"X-Organization-Id","in":"header","description":"Selected organization ID for the request context","schema":{"type":"string"}},{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"entityType","required":true,"in":"path","schema":{"type":"string"}},{"name":"entityId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Tag detached from entity"},"401":{"description":"Missing or invalid token"},"403":{"description":"Insufficient role or organization"},"404":{"description":"Tag not found"}},"security":[{"access-token":[]}],"tags":["tags"]}},"/api/me":{"get":{"operationId":"UsersController_getMe","parameters":[],"responses":{"200":{"description":""}},"security":[{"bearer":[]}],"tags":["Users"]}}},"info":{"title":"Travel SaaS API","description":"API for the Travel SaaS Platform. All endpoints require a valid JWT Bearer token (Logto) and the `X-Organization-Id` header for organization context.","version":"1.0","contact":{}},"tags":[{"name":"leads","description":"Lead management"},{"name":"requests","description":"Travel request management"},{"name":"clients","description":"Client management"},{"name":"offers","description":"Offer management"}],"servers":[],"components":{"securitySchemes":{"access-token":{"scheme":"bearer","bearerFormat":"JWT","type":"http","name":"Authorization"}},"schemas":{"CreateActivityDto":{"type":"object","properties":{"entityType":{"type":"string","enum":["Lead","Client","Request","Offer","Booking"]},"entityId":{"type":"string","format":"uuid"},"type":{"type":"string","maxLength":80,"example":"note","description":"e.g. note, call, status_change"},"payload":{"type":"object","description":"Optional JSON payload"}},"required":["entityType","entityId","type"]},"ActivityResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"entityType":{"type":"string"},"entityId":{"type":"string","format":"uuid"},"type":{"type":"string"},"payload":{"type":"object","nullable":true},"createdAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","entityType","entityId","type","payload","createdAt"]},"CreateBookingDto":{"type":"object","properties":{"offerId":{"type":"string","format":"uuid"}},"required":["offerId"]},"BookingResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"offerId":{"type":"string","format":"uuid"},"clientId":{"type":"string","format":"uuid"},"agreedPrice":{"type":"string","description":"Decimal as string"},"currency":{"type":"string"},"status":{"type":"string","enum":["CONFIRMED","CANCELLED"]},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","offerId","clientId","agreedPrice","currency","status","createdAt","updatedAt"]},"PaginatedBookingResponseDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/BookingResponseDto"}},"total":{"type":"number","description":"Total number of items across all pages"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Page size (items per page)"}},"required":["data","total","page","limit"]},"UpdateBookingDto":{"type":"object","properties":{"status":{"type":"string","enum":["CONFIRMED","CANCELLED"]}}},"CreateClientDto":{"type":"object","properties":{"type":{"enum":["INDIVIDUAL","AGENT"],"type":"string"},"name":{"type":"string"},"phone":{"type":"string"},"email":{"type":"string"}},"required":["type","name"]},"ClientResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"type":{"type":"string","enum":["INDIVIDUAL","AGENT"]},"name":{"type":"string"},"phone":{"type":"string","nullable":true},"email":{"type":"string","nullable":true},"comment":{"type":"string","nullable":true},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","type","name","phone","email","comment","createdAt","updatedAt"]},"PaginatedClientResponseDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/ClientResponseDto"}},"total":{"type":"number","description":"Total number of items across all pages"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Page size (items per page)"}},"required":["data","total","page","limit"]},"UpdateClientDto":{"type":"object","properties":{"type":{"enum":["INDIVIDUAL","AGENT"],"type":"string"},"name":{"type":"string"},"phone":{"type":"string"},"email":{"type":"string"},"comment":{"type":"string"}}},"CreateCommentDto":{"type":"object","properties":{"commentableType":{"type":"string","enum":["Lead","Client","Request","Offer","Booking"]},"commentableId":{"type":"string","format":"uuid"},"body":{"type":"string","minLength":1,"maxLength":10000,"example":"Called back, client interested."}},"required":["commentableType","commentableId","body"]},"CommentResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"commentableType":{"type":"string"},"commentableId":{"type":"string","format":"uuid"},"body":{"type":"string"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","commentableType","commentableId","body","createdAt","updatedAt"]},"CreateInvoiceDto":{"type":"object","properties":{"bookingId":{"type":"string","format":"uuid"},"dueDate":{"type":"string"}},"required":["bookingId"]},"InvoiceResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"bookingId":{"type":"string","format":"uuid"},"number":{"type":"string"},"issueDate":{"format":"date-time","type":"string"},"dueDate":{"format":"date-time","type":"string","nullable":true},"amount":{"type":"string","description":"Decimal as string"},"currency":{"type":"string"},"status":{"type":"string","enum":["DRAFT","SENT","PAID","CANCELLED"]},"pdfUrl":{"type":"string","nullable":true},"createdAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","bookingId","number","issueDate","dueDate","amount","currency","status","pdfUrl","createdAt"]},"PaginatedInvoiceResponseDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/InvoiceResponseDto"}},"total":{"type":"number","description":"Total number of items across all pages"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Page size (items per page)"}},"required":["data","total","page","limit"]},"UpdateInvoiceDto":{"type":"object","properties":{"status":{"type":"string","enum":["DRAFT","SENT","PAID","CANCELLED"]},"dueDate":{"type":"string","format":"date-time"},"pdfUrl":{"type":"string"}}},"CreateLeadDto":{"type":"object","properties":{"source":{"enum":["PHONE","EMAIL","WHATSAPP","AGENT","OTHER"],"type":"string"},"contactName":{"type":"string"},"contactEmail":{"type":"string"},"contactPhone":{"type":"string"},"notes":{"type":"string"}},"required":["source","contactName"]},"LeadResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"source":{"type":"string","enum":["PHONE","EMAIL","WHATSAPP","AGENT","OTHER"]},"contactName":{"type":"string"},"contactEmail":{"type":"string","nullable":true},"contactPhone":{"type":"string","nullable":true},"notes":{"type":"string","nullable":true},"status":{"type":"string","enum":["NEW","IN_PROGRESS","LOST","CONVERTED"]},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","source","contactName","contactEmail","contactPhone","notes","status","createdAt","updatedAt"]},"PaginatedLeadResponseDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/LeadResponseDto"}},"total":{"type":"number","description":"Total number of items across all pages"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Page size (items per page)"}},"required":["data","total","page","limit"]},"UpdateLeadStatusDto":{"type":"object","properties":{"status":{"enum":["NEW","IN_PROGRESS","LOST","CONVERTED"],"type":"string"}},"required":["status"]},"UpdateLeadDto":{"type":"object","properties":{"source":{"enum":["PHONE","EMAIL","WHATSAPP","AGENT","OTHER"],"type":"string"},"contactName":{"type":"string"},"contactEmail":{"type":"string"},"contactPhone":{"type":"string"},"notes":{"type":"string"}}},"OfferResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"requestId":{"type":"string","format":"uuid"},"title":{"type":"string"},"source":{"type":"string","enum":["MANUAL","OSTROVOK"]},"status":{"type":"string","enum":["DRAFT","SENT","ACCEPTED","REJECTED","EXPIRED"]},"supplierTotal":{"type":"string","description":"Decimal as string"},"markup":{"type":"string","description":"Decimal as string"},"commission":{"type":"string","description":"Decimal as string"},"finalPrice":{"type":"string","description":"Decimal as string"},"currency":{"type":"string"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","requestId","title","source","status","supplierTotal","markup","commission","finalPrice","currency","createdAt","updatedAt"]},"PaginatedOfferResponseDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/OfferResponseDto"}},"total":{"type":"number","description":"Total number of items across all pages"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Page size (items per page)"}},"required":["data","total","page","limit"]},"CreateOfferDto":{"type":"object","properties":{"duplicateFromId":{"type":"string","format":"uuid","description":"Copy from existing offer (other fields optional)"},"requestId":{"type":"string","format":"uuid"},"title":{"type":"string"},"supplierTotal":{"type":"number"},"markup":{"type":"number"},"commission":{"type":"number"},"finalPrice":{"type":"number"},"currency":{"type":"string"}}},"UpdateOfferDto":{"type":"object","properties":{"title":{"type":"string"},"supplierTotal":{"type":"number"},"markup":{"type":"number"},"commission":{"type":"number"},"finalPrice":{"type":"number"},"currency":{"type":"string"}}},"UpdateOfferStatusDto":{"type":"object","properties":{"status":{"type":"string","enum":["SENT","ACCEPTED","REJECTED","EXPIRED"]}},"required":["status"]},"CreateOrganizationDto":{"type":"object","properties":{"name":{"type":"string"},"defaultCurrency":{"type":"string"}},"required":["name"]},"CreateRequestDto":{"type":"object","properties":{"clientId":{"type":"string","format":"uuid"},"managerId":{"type":"string","format":"uuid","description":"User ID of the manager"},"destination":{"type":"string"},"startDate":{"type":"string","example":"2025-06-01"},"endDate":{"type":"string","example":"2025-06-15"},"adults":{"type":"number"},"children":{"type":"number","default":0},"comment":{"type":"string"}},"required":["clientId","managerId","destination","startDate","endDate","adults"]},"RequestResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"clientId":{"type":"string","format":"uuid"},"managerId":{"type":"string","format":"uuid"},"destination":{"type":"string"},"startDate":{"format":"date-time","type":"string"},"endDate":{"format":"date-time","type":"string"},"adults":{"type":"number"},"children":{"type":"number"},"comment":{"type":"string","nullable":true},"status":{"type":"string","enum":["NEW","IN_PROGRESS","OFFERED","CLOSED"]},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","clientId","managerId","destination","startDate","endDate","adults","children","comment","status","createdAt","updatedAt"]},"PaginatedRequestResponseDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/RequestResponseDto"}},"total":{"type":"number","description":"Total number of items across all pages"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Page size (items per page)"}},"required":["data","total","page","limit"]},"UpdateRequestDto":{"type":"object","properties":{"clientId":{"type":"string","format":"uuid"},"managerId":{"type":"string","format":"uuid"},"destination":{"type":"string"},"startDate":{"type":"string"},"endDate":{"type":"string"},"adults":{"type":"number"},"children":{"type":"number"},"comment":{"type":"string"}}},"UpdateRequestStatusDto":{"type":"object","properties":{"status":{"type":"string","enum":["NEW","IN_PROGRESS","OFFERED","CLOSED"]}},"required":["status"]},"CreateTagDto":{"type":"object","properties":{"name":{"type":"string","minLength":1,"maxLength":100,"example":"vip"}},"required":["name"]},"TagResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"organizationId":{"type":"string","format":"uuid"},"name":{"type":"string"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","organizationId","name","createdAt","updatedAt"]},"AttachTagDto":{"type":"object","properties":{"entityType":{"type":"string","enum":["Lead","Client","Request","Offer","Booking"]},"entityId":{"type":"string","format":"uuid"}},"required":["entityType","entityId"]}}}}